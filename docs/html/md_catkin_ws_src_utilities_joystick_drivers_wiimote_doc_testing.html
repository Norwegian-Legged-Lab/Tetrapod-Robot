<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tetrapod Project: Testing procedures for the WiiMote package</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo1.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Tetrapod Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Testing procedures for the WiiMote package </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="autotoc_md43"></a>
Python compatiblity test script</h2>
<p>After building the package the first thing one should run is the python test script</p>
<p>The script will look for compatible Wiimotes. The package is <b>not</b> compatible with the newer Wiimotes. The compatible Wiimotes are the <b>Nintendo RVL-CNT-01</b> and <b>Nintendo RVL-WBC-01</b>.</p>
<div class="fragment"><div class="line">$ python wiimote/scripts/wiimote_test.py</div>
<div class="line">Looking for compatible devices</div>
<div class="line">Incompatible controller:</div>
<div class="line"> CC:FB:65:E6:62:1D - Nintendo RVL-CNT-01-TR</div>
<div class="line">Compatible controller:</div>
<div class="line"> 00:17:AB:37:FF:5E - Nintendo RVL-CNT-01</div>
</div><!-- fragment --><p>In the above example two wiimotes were deteced but only one is compatible with the wiimote package.</p>
<hr  />
<h2><a class="anchor" id="autotoc_md45"></a>
Running the wiimote nodes</h2>
<p>The package consists of two primary nodes: &gt;wiimote_node wiimote_node.py</p>
<p>The C++ implementation was design with focus on reduced resource consumption and is recommended over the python variant.</p>
<hr  />
<h3><a class="anchor" id="autotoc_md47"></a>
Wiimote_node</h3>
<p>Running the wiimote_node is straight forward, ensure bluetooth is enabled on your machine and put the Wiimote in discoverable mode (press 1+2)</p>
<div class="fragment"><div class="line">$ rosrun wiimote wiimote_node</div>
<div class="line">[ INFO] [1498662258.081403347]: * * * Pairing</div>
<div class="line">[ INFO] [1498662258.081474540]: Allow all joy sticks to remain at center position until calibrated.</div>
<div class="line">[ INFO] [1498662258.081506464]: Put Wiimote in discoverable mode now (press 1+2)...</div>
<div class="line">[ INFO] [1498662258.081540133]: Timeout in about 5 seconds if not paired.</div>
<div class="line">[ INFO] [1498662835.763122784]: Collecting additional calibration data; keep wiimote stationary...</div>
<div class="line">[ INFO] [1498662836.780853688]: Wiimote is Paired</div>
</div><!-- fragment --><p>The wiimote is now paired and is publisihing to several different topics. Listing the Ros topics should yield something similar to:</p>
<div class="fragment"><div class="line">$ rostopic list</div>
<div class="line">/imu/data</div>
<div class="line">/imu/is_calibrated</div>
<div class="line">/joy</div>
<div class="line">/joy/set_feedback</div>
<div class="line">/rosout</div>
<div class="line">/rosout_agg</div>
<div class="line">/wiimote/state</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md48"></a>
Possible Errors</h4>
<p>&gt;If the Wiimote fails to connect try pressing the red sync button on the back of the remote and run the node again. The script could also be timing out before it is able to find the Wiimote aswell. If this is suspected try running the node with the following parameters: ` $ rosrun wiimote wiimote_node _pair_timeout:=-1 ` &gt;This will make the script search indefinitly until closed.</p>
<p>To see if the Wiimote is working properly echo the /wiimote/state topic </p><div class="fragment"><div class="line">$rostopic echo /wiimote/state</div>
<div class="line">---</div>
<div class="line">header:</div>
<div class="line">  seq: 485</div>
<div class="line">  stamp:</div>
<div class="line">    secs: 1498664301</div>
<div class="line">    nsecs: 333370601</div>
<div class="line">  frame_id: &#39;&#39;</div>
<div class="line">angular_velocity_zeroed:</div>
<div class="line">  x: 0.0</div>
<div class="line">  y: 0.0</div>
<div class="line">  z: 0.0</div>
<div class="line">angular_velocity_raw:</div>
<div class="line">  x: 0.0</div>
<div class="line">  y: 0.0</div>
<div class="line">  z: 0.0</div>
<div class="line">angular_velocity_covariance: [-1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</div>
<div class="line">linear_acceleration_zeroed:</div>
<div class="line">  x: 1.63444166667</div>
<div class="line">  y: 0.338160344828</div>
<div class="line">  z: 9.80665</div>
<div class="line">linear_acceleration_raw:</div>
<div class="line">  x: 144.0</div>
<div class="line">  y: 140.0</div>
<div class="line">  z: 161.0</div>
<div class="line">linear_acceleration_covariance: [0.0, 0.0, 0.0, 0.0, 0.7766074343434308, 0.0, 0.0, 0.0, 1.1203354696969712]</div>
<div class="line">nunchuk_acceleration_zeroed:</div>
<div class="line">  x: 0.0</div>
<div class="line">  y: 0.0</div>
<div class="line">  z: 0.0</div>
<div class="line">nunchuk_acceleration_raw:</div>
<div class="line">  x: 0.0</div>
<div class="line">  y: 0.0</div>
<div class="line">  z: 0.0</div>
<div class="line">nunchuk_joystick_zeroed: [0.0, 0.0]</div>
<div class="line">nunchuk_joystick_raw: [0.0, 0.0]</div>
<div class="line">buttons: [False, False, False, False, False, False, False, False, False, False, False]</div>
<div class="line">nunchuk_buttons: [False, False]</div>
<div class="line">LEDs: [False, False, False, False]</div>
<div class="line">rumble: False</div>
<div class="line">ir_tracking:</div>
<div class="line">  -</div>
<div class="line">    x: -1.0</div>
<div class="line">    y: -1.0</div>
<div class="line">    ir_size: -1</div>
<div class="line">  -</div>
<div class="line">    x: -1.0</div>
<div class="line">    y: -1.0</div>
<div class="line">    ir_size: -1</div>
<div class="line">  -</div>
<div class="line">    x: -1.0</div>
<div class="line">    y: -1.0</div>
<div class="line">    ir_size: -1</div>
<div class="line">  -</div>
<div class="line">    x: -1.0</div>
<div class="line">    y: -1.0</div>
<div class="line">    ir_size: -1</div>
<div class="line">raw_battery: 155.0</div>
<div class="line">percent_battery: 74.5192337036</div>
<div class="line">zeroing_time:</div>
<div class="line">  secs: 1498662949</div>
<div class="line">  nsecs: 612081279</div>
<div class="line">errors: 0</div>
<div class="line">---</div>
</div><!-- fragment --><p>Test it out! Move the Wiimote and see the corresponding values change on the terminal.</p>
<hr  />
 <h2><a class="anchor" id="autotoc_md50"></a>
Wiimote_node.py</h2>
<p>The process for the python variant is similar to the C++ version. Put the Wiimote in discoverable mode (press 1+2) and run the script.</p>
<div class="fragment"><div class="line">$ rosrun wiimote wiimote_node.py</div>
<div class="line">Press buttons 1 and 2 together to pair (within 6 seconds).</div>
<div class="line">    (If no blinking lights, press power button for ~3 seconds.)</div>
</div><!-- fragment --><p>Echo the output onto the screen using the same <code>$ rosparam echo /wiimote/state</code> used above.</p>
<h2><a class="anchor" id="autotoc_md51"></a>
Topics</h2>
<h4><a class="anchor" id="autotoc_md52"></a>
Subscribed topics</h4>
<ul>
<li>set_feedback (sensor_msgs/JoyFeedbackArray) <em>Topic where ROS clients control the Wiimote's leds and rumble (vibrator) facility.</em></li>
</ul>
<h4><a class="anchor" id="autotoc_md53"></a>
Published Topics</h4>
<ul>
<li><p class="startli">joy (joy/Joy)</p>
<p class="startli"><em>Topic on which Wiimote accelerometer, gyro, and button data are published. Axes are: linear AccelerationX/Y/Z, followed by angular velocityX/Y/Z (a.k.a. Roll, Pitch, Yaw, a.k.a. Phi, Theta, Psi). The values are corrected to be near zero at rest. For raw values, use the State message. The Wiimote buttons are reported in the same order as in the State message</em> <br  />
</p>
</li>
<li><p class="startli">imu/data (sensor_msgs/Imu)</p>
<p class="startli"><em>Topic on which Wiimote gyro and accelerometer data are sent out.</em> <br  />
</p>
</li>
<li><p class="startli">wiimote/state (wiimote/State)</p>
<p class="startli"><em>Topic for comprehensive information about Wiimote state.</em> <br  />
</p>
</li>
<li><p class="startli">wiimote/nunchuk (joy/Joy)</p>
<p class="startli"><em>Topic on which data from an attached Nunchuk are sent out, including the joystick, accelerometer and button data. Axes are: <a class="el" href="classJoystick.html" title="Opens, reads from and publishes joystick events.">Joystick</a> X/Y, Acceleration X/Y/Z. The buttons are Z then C. Note the spelling of the topic name does not include a 'c'.</em> <br  />
</p>
</li>
<li><p class="startli">wiimote/classic (joy/Joy)</p>
<p class="startli"><em>Topic on which data for a Wiimote classic attachment are sent out (Untested by Willow Garage).</em> <br  />
</p>
</li>
<li><p class="startli">imu/is_calibrated (std_msgs/Bool)</p>
<p class="startli"><em>Latched topic for learning the most recent Wiimote calibration result.</em> <br  />
 </p>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
